on: 
    push:
      branches:
        - main
name: ðŸš€ Deploy website on push
  
jobs:
    web-server-deploy:
        # The type of runner that the job will run on
        runs-on: ubuntu-latest


        steps:
        - name: Deploy using ssh
          uses: appleboy/ssh-action@master
          with:
            host: ${{ secrets.HOST }}
            username: ${{ secrets.USERNAME }}
            password: ${{ secrets.PASSWORD }}
            port: 22
            script: |
              export NVM_DIR=~/.nvm
              source ~/.nvm/nvm.sh
              cd /var/www/vhosts/elvirainfotech.org/fmiordersystem
              eval "$(ssh-agent -s)"
              ssh-add ~/.ssh/somnath_git_deploy_key
              git pull origin main
              git status
              npm install --force
              pm2 restart 2
              cd fmi_frontend
              npm install --force
              npm run build --force

    web-deploy:
      name: ðŸŽ‰ Deploy
      runs-on: ubuntu-latest
      steps:
      - name: ðŸšš Get latest code
        uses: actions/checkout@v3
  
      - name: Use Node.js 20
        uses: actions/setup-node@v2
        with:
          node-version: '20'
        
      - name: ðŸ”¨ Build Project
        run: |
          cd fmi_frontend
          npm install --force
          npm run build

      
      - name: ðŸ“‚ Sync files
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: culturalcupid.com
          username: culturalcupid_corner@culturalcupid.com
          password: IO(8fYWHPeWC
          protocol: ftp
          local-dir: ./build/


               

        


      
      